<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Movie / TV Search UI — Fetch API</title>
  <style>
    :root{--bg:#0f1724;--card:#0b1220;--muted:#94a3b8;--accent:#06b6d4}
    *{box-sizing:border-box}
    body{margin:0;font-family:Inter,system-ui,Segoe UI,Roboto,Arial;min-height:100vh;background:linear-gradient(180deg,#071022 0%,#0b1220 60%);color:#e6eef6}
    header{padding:20px 18px;display:flex;gap:16px;align-items:center;justify-content:space-between}
    .brand{display:flex;gap:12px;align-items:center}
    .logo{width:44px;height:44px;border-radius:10px;background:linear-gradient(135deg,var(--accent),#7c3aed);display:flex;align-items:center;justify-content:center;font-weight:700}
    h1{font-size:18px;margin:0}
    .controls{display:flex;gap:12px;align-items:center}
    .search{display:flex;align-items:center;background:rgba(255,255,255,0.03);padding:8px;border-radius:10px;gap:8px}
    .search input{background:transparent;border:0;outline:none;color:inherit;padding:6px 8px;width:260px}
    .btn{background:var(--accent);border:0;padding:8px 12px;border-radius:8px;color:#072233;font-weight:600;cursor:pointer}
    main{padding:18px}
    .meta{display:flex;gap:12px;align-items:center;margin-bottom:12px}
    .results{display:grid;grid-template-columns:repeat(auto-fill,minmax(200px,1fr));gap:14px}
    .card{background:linear-gradient(180deg,rgba(255,255,255,0.02),transparent);border-radius:12px;overflow:hidden;box-shadow:0 6px 18px rgba(2,6,23,0.6);transition:transform .18s ease,box-shadow .18s ease}
    .card:hover{transform:translateY(-6px);box-shadow:0 12px 30px rgba(2,6,23,0.8)}
    .thumb{height:300px;background:#071022;background-size:cover;background-position:center}
    .card-body{padding:12px}
    .title{font-weight:700;font-size:15px;margin-bottom:6px}
    .sub{color:var(--muted);font-size:13px;margin-bottom:8px}
    .tags{display:flex;gap:8px;flex-wrap:wrap}
    .tag{background:rgba(255,255,255,0.03);padding:6px 8px;border-radius:8px;font-size:12px}
    .empty{padding:40px;border-radius:12px;background:rgba(255,255,255,0.02);text-align:center;color:var(--muted)}
    /* modal */
    .modal-backdrop{position:fixed;inset:0;background:rgba(2,6,23,0.7);display:flex;align-items:center;justify-content:center;z-index:80}
    .modal{width:min(920px,96%);max-height:86vh;overflow:auto;background:linear-gradient(180deg,#071028,#071022);border-radius:12px;padding:18px;border:1px solid rgba(255,255,255,0.03)}
    .modal-grid{display:grid;grid-template-columns:260px 1fr;gap:18px}
    .poster{height:380px;background-size:cover;background-position:center;border-radius:8px}
    .close{background:transparent;border:0;color:var(--muted);font-weight:700;cursor:pointer}
    footer{padding:10px 18px;color:var(--muted);font-size:13px}
    @media (max-width:720px){.modal-grid{grid-template-columns:1fr}.thumb{height:220px}.poster{height:260px}.search input{width:140px}}
  </style>
</head>
<body>
  <header>
    <div class="brand">
      <div class="logo">MV</div>
      <div>
        <h1>Movie / TV Search</h1>
        <div style="color:var(--muted);font-size:13px">Powered by TVMaze (no API key)</div>
      </div>
    </div>

    <div class="controls">
      <div class="search">
        <svg width="18" height="18" viewBox="0 0 24 24" fill="none"><path d="M21 21l-4.35-4.35" stroke="currentColor" stroke-width="1.6" stroke-linecap="round" stroke-linejoin="round"></path><circle cx="11" cy="11" r="6" stroke="currentColor" stroke-width="1.6"></circle></svg>
        <input id="q" placeholder="Search movie or show (e.g. 'batman')" />
        <button id="searchBtn" class="btn">Search</button>
      </div>
    </div>
  </header>

  <main>
    <div class="meta">
      <div id="count" style="color:var(--muted)"></div>
      <div style="margin-left:auto;color:var(--muted)">Tip: click a card for more details</div>
    </div>

    <div id="results" class="results"></div>

    <div id="empty" class="empty" style="display:none">No results yet — try searching for something like "friends", "inception", "office"</div>
  </main>

  <footer>Built with <strong>fetch()</strong> • Data from <a href="https://www.tvmaze.com/api" target="_blank" style="color:var(--accent)">TVMaze API</a></footer>

  <!-- Modal container (created dynamically) -->
  <script>
    // Helpers
    const $ = (s, el=document) => el.querySelector(s);
    const $$ = (s, el=document) => Array.from(el.querySelectorAll(s));

    const qInput = $('#q');
    const searchBtn = $('#searchBtn');
    const resultsEl = $('#results');
    const emptyEl = $('#empty');
    const countEl = $('#count');

    // Debounce to avoid spamming requests while typing
    function debounce(fn, wait=350){ let t; return (...args)=>{ clearTimeout(t); t=setTimeout(()=>fn(...args), wait); } }

    // Render a single result card
    function renderCard(item){
      const show = item.show || item; // TVMaze returns {score, show}
      const div = document.createElement('article');
      div.className = 'card';

      const image = show.image && show.image.medium ? show.image.medium : '';
      const posterStyle = image ? `background-image:url(${image})` : '';

      div.innerHTML = `
        <div class="thumb" style="${posterStyle}"></div>
        <div class="card-body">
          <div class="title">${escapeHtml(show.name || 'Untitled')}</div>
          <div class="sub">${escapeHtml((show.genres||[]).slice(0,3).join(', ') || 'Genre unknown')}</div>
          <div class="tags">
            <div class="tag">Premiered: ${show.premiered ? show.premiered : 'N/A'}</div>
            <div class="tag">Type: ${show.type || 'N/A'}</div>
            <div class="tag">Rating: ${show.rating && show.rating.average ? show.rating.average : '—'}</div>
          </div>
        </div>
      `;

      div.addEventListener('click', ()=>openModal(show));
      return div;
    }

    function escapeHtml(str){ return String(str || '').replace(/[&<>\"']/g, (s)=>({"&":"&amp;","<":"&lt;",">":"&gt;","\"":"&quot;","'":"&#39;"}[s])); }

    function showEmpty(msg){ emptyEl.style.display='block'; resultsEl.innerHTML=''; countEl.textContent=''; emptyEl.textContent = msg || 'No results found.' }
    function hideEmpty(){ emptyEl.style.display='none' }

    // Open modal with show details
    function openModal(show){
      const backdrop = document.createElement('div');
      backdrop.className = 'modal-backdrop';
      backdrop.innerHTML = `
        <div class="modal" role="dialog" aria-modal="true">
          <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:8px">
            <strong style="font-size:16px">${escapeHtml(show.name)}</strong>
            <button class="close">Close ✕</button>
          </div>
          <div class="modal-grid">
            <div>
              <div class="poster" style="background-image:url(${show.image && show.image.original ? show.image.original : (show.image && show.image.medium ? show.image.medium : '')})"></div>
              <div style="margin-top:10px;color:var(--muted)">Official site: <a href="${show.officialSite || '#'}" target="_blank" style="color:var(--accent)">${show.officialSite || '—'}</a></div>
            </div>
            <div>
              <div style="color:var(--muted);margin-bottom:10px">${escapeHtml(show.genres && show.genres.length ? show.genres.join(', ') : 'Genres unknown')}</div>
              <div style="line-height:1.45;color:#dbeafe">${show.summary ? show.summary : 'No summary available.'}</div>

              <div style="margin-top:12px;color:var(--muted)">
                <div><strong>Premiered:</strong> ${show.premiered || 'N/A'}</div>
                <div><strong>Status:</strong> ${show.status || 'N/A'}</div>
                <div><strong>Type:</strong> ${show.type || 'N/A'}</div>
                <div><strong>Rating:</strong> ${show.rating && show.rating.average ? show.rating.average : '—'}</div>
              </div>
            </div>
          </div>
        </div>
      `;

      backdrop.addEventListener('click', (e)=>{ if(e.target===backdrop) closeModal(backdrop); });
      backdrop.querySelector('.close').addEventListener('click', ()=>closeModal(backdrop));
      document.body.appendChild(backdrop);
      document.body.style.overflow='hidden';
    }
    function closeModal(backdrop){ backdrop.remove(); document.body.style.overflow='auto'; }

    // Search function using TVMaze (no API key required)
    async function search(query){
      if(!query || query.trim().length<1){ showEmpty('Type a search term (e.g. "friends", "batman").'); return }
      resultsEl.innerHTML=''; countEl.textContent='Searching...'; hideEmpty();
      try{
        const resp = await fetch(`https://api.tvmaze.com/search/shows?q=${encodeURIComponent(query)}`);
        if(!resp.ok) throw new Error('Network response not OK');
        const data = await resp.json();
        if(!Array.isArray(data) || data.length===0){ showEmpty('No results found. Try another query.'); return }
        countEl.textContent = `${data.length} result(s)`;
        resultsEl.innerHTML='';
        data.forEach(item=> resultsEl.appendChild(renderCard(item)));
      }catch(err){
        showEmpty('Failed to fetch — check your connection or try again later.');
        console.error(err);
      }
    }

    // Wire up events
    const doSearch = debounce(() => search(qInput.value.trim()), 300);
    qInput.addEventListener('input', doSearch);
    searchBtn.addEventListener('click', ()=>search(qInput.value.trim()));

    // Optional: initial demo search
    // search('office');

    // Accessibility / keyboard
    document.addEventListener('keydown', (e)=>{
      if(e.key === 'Escape'){
        const bd = document.querySelector('.modal-backdrop'); if(bd) closeModal(bd);
      }
    });

    // If you want to use OMDb or TMDB instead, replace the fetch URL above with their endpoints and include an API key.
  </script>
</body>
</html>
